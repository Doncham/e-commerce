{
  "openapi": "3.0.1",
  "info": {
    "title": "Default module",
    "description": "사용자 주소 등록 API. `isDefault=true`로 생성 시 기존 기본 주소는 트랜잭션 내에서 자동 해제됩니다.\n멱등성을 위해 `Idempotency-Key` 헤더를 지원합니다.\n",
    "version": "1.0.0"
  },
  "tags": [
    {
      "name": "Address"
    },
    {
      "name": "Product"
    },
    {
      "name": "Inventory"
    },
    {
      "name": "AdminCoupon"
    },
    {
      "name": "Coupon"
    },
    {
      "name": "Cart"
    },
    {
      "name": "Order"
    },
    {
      "name": "Payment"
    }
  ],
  "paths": {
    "/api/v1/addresses/{id}": {
      "get": {
        "summary": "주소 조회",
        "deprecated": false,
        "description": "특정 주소 ID로 주소 정보를 조회합니다.",
        "tags": [
          "Address"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddressResponse"
                },
                "example": {
                  "id": 101,
                  "receiver": "홍길동",
                  "phone": "01012345678",
                  "zipcode": "06236",
                  "memo": "문 앞에 두세요",
                  "isDefault": true,
                  "createdAt": "2025-11-02T07:00:00Z"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "headers": {}
          },
          "404": {
            "description": "존재하지 않는 주소",
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth7": []
          }
        ]
      },
      "put": {
        "summary": "주소 수정",
        "deprecated": false,
        "description": "특정 주소 ID의 정보를 수정합니다.",
        "tags": [
          "Address"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddressUpdateRequest"
              },
              "example": {
                "receiver": "이순신",
                "phone": "01099998888",
                "zipcode": "04524",
                "memo": "회사 리셉션 보관",
                "isDefault": false
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddressResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "유효성 검증 실패",
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "headers": {}
          },
          "403": {
            "description": "소유자 불일치",
            "headers": {}
          },
          "404": {
            "description": "존재하지 않는 주소",
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth7": []
          }
        ]
      },
      "delete": {
        "summary": "주소 삭제",
        "deprecated": false,
        "description": "특정 주소 ID를 삭제합니다.",
        "tags": [
          "Address"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "삭제 성공(본문 없음)",
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "headers": {}
          },
          "403": {
            "description": "소유자 불일치",
            "headers": {}
          },
          "404": {
            "description": "존재하지 않는 주소",
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth7": []
          }
        ]
      }
    },
    "/api/v1/addresses": {
      "post": {
        "summary": "주소 등록",
        "deprecated": false,
        "description": "새 주소를 등록합니다. `isDefault=true`로 요청하면 기존 기본 주소는 자동으로 `false`로 내려가며,단일성 충돌 발생 시 409를 반환할 수 있습니다.\n",
        "operationId": "createAddress",
        "tags": [
          "Address"
        ],
        "parameters": [
          {
            "name": "Idempotency-Key",
            "in": "header",
            "description": "중복 요청에 대한 멱등 처리 키(선택). 동일 키로 같은 본문 재요청 시 201 또는 이전 결과를 재전달합니다.",
            "required": false,
            "example": "",
            "schema": {
              "type": "string",
              "maxLength": 64
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddressCreateRequest"
              },
              "examples": {
                "createDefault": {
                  "value": {
                    "receiver": "홍길동",
                    "phone": "01012345678",
                    "zipcode": "06236",
                    "memo": "경비실 맡겨주세요",
                    "isDefault": true
                  },
                  "summary": "기본 주소로 등록"
                },
                "createNonDefault": {
                  "value": {
                    "receiver": "회사",
                    "phone": "0212345678",
                    "zipcode": "04524",
                    "memo": "리셉션 보관",
                    "isDefault": false
                  },
                  "summary": "일반 주소 등록"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "생성 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddressResponse"
                },
                "example": {
                  "id": 1001,
                  "receiver": "홍길동",
                  "phone": "01012345678",
                  "zipcode": "06236",
                  "memo": "경비실 맡겨주세요",
                  "isDefault": true,
                  "createdAt": "2025-11-02T06:10:00Z"
                }
              }
            },
            "headers": {
              "Location": {
                "description": "생성된 리소스의 절대 URL",
                "schema": {
                  "type": "string",
                  "format": "uri"
                }
              }
            }
          },
          "400": {
            "description": "유효성 검증 실패 (형식 오류/필수값 누락 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationErrorResponse"
                },
                "examples": {
                  "2": {
                    "summary": "invalidPhone",
                    "value": {
                      "status": 400,
                      "error": "Bad Request",
                      "code": "VALIDATION_ERROR",
                      "message": "Validation failed.",
                      "path": "/api/v1/addresses",
                      "timestamp": "2025-11-02T06:11:00Z",
                      "details": [
                        {
                          "field": "phone",
                          "reason": "must be 7-20 digits or E.164 format"
                        }
                      ],
                      "traceId": "cc44dd55ee66"
                    }
                  },
                  "3": {
                    "summary": "invalidZipcode",
                    "value": {
                      "status": 400,
                      "error": "Bad Request",
                      "code": "INVALID_ZIPCODE_FORMAT",
                      "message": "Zipcode must be 3-10 characters.",
                      "path": "/api/v1/addresses",
                      "timestamp": "2025-11-02T06:11:30Z",
                      "traceId": "ab12cd34ef56"
                    }
                  }
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패(JWT 누락/만료/서명 오류)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "status": 401,
                  "error": "Unauthorized",
                  "code": "INVALID_TOKEN",
                  "message": "Token is missing or invalid.",
                  "path": "/api/v1/addresses",
                  "timestamp": "2025-11-02T06:12:00Z",
                  "traceId": "b1a9b2c3d4e5"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "기본 주소 단일성 충돌(동시성/경합 시)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "status": 409,
                  "error": "Conflict",
                  "code": "DEFAULT_ADDRESS_CONFLICT",
                  "message": "Another default address exists. Retry your request.",
                  "path": "/api/v1/addresses",
                  "timestamp": "2025-11-02T06:15:00Z",
                  "traceId": "7d9a0b57e4f54d9c8b7a"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth7": []
          }
        ]
      }
    },
    "/api/v1/auth/signup": {
      "post": {
        "summary": "회원가입",
        "deprecated": false,
        "description": "",
        "tags": [],
        "parameters": [],
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SignupResponse"
                }
              }
            },
            "headers": {
              "Location": {
                "description": "생성된 사용자 리소스 URL",
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "잘못된 요청",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "status": 400,
                  "error": "Bad Request",
                  "code": "INVALID_EMAIL_FORMAT",
                  "message": "Email format is invalid.",
                  "path": "/api/v1/auth/signup",
                  "timestamp": "2025-11-01T06:15:30.000Z"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "충돌(중복 이메일)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "status": 409,
                  "error": "Conflict",
                  "code": "EMAIL_CONFLICT",
                  "message": "email already exists",
                  "path": "/api/v1/auth/signup",
                  "timestamp": "2025-11-01T06:15:30.000Z"
                }
              }
            },
            "headers": {}
          }
        },
        "security": []
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "summary": "로그인",
        "deprecated": false,
        "description": "",
        "tags": [],
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "잘못된 요청",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": []
      }
    },
    "/api/v1/products": {
      "post": {
        "summary": "제품 등록",
        "deprecated": false,
        "description": "새로운 제품을 등록합니다.",
        "tags": [
          "Product"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProductCreateRequest"
              },
              "example": {
                "name": "프리미엄 커피 원두 1kg",
                "description": "고소한 향의 아라비카 블렌드 원두",
                "price": 19900,
                "isActive": true
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "생성 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "유효성 검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "500": {
            "description": "서버 오류",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth11": []
          }
        ]
      },
      "get": {
        "summary": "제품 목록 조회",
        "deprecated": false,
        "description": "페이징/간단 필터 지원",
        "tags": [
          "Product"
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            }
          },
          {
            "name": "size",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "string",
              "example": "createdAt,desc"
            }
          },
          {
            "name": "isActive",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "q",
            "in": "query",
            "description": "검색을 위한 키워드",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "목록 조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductPageResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth11": []
          }
        ]
      }
    },
    "/api/v1/products/{id}": {
      "get": {
        "summary": "제품 상세 조회",
        "deprecated": false,
        "description": "",
        "tags": [
          "Product"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "존재하지 않는 제품",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "status": 400,
                  "error": "Bad Request",
                  "code": "VALIDATION_ERROR",
                  "message": "product doesn't exist.",
                  "path": "/api/v1/products",
                  "timestamp": "2025-11-02T07:31:00.000Z"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth11": []
          }
        ]
      },
      "put": {
        "summary": "제품 수정",
        "deprecated": false,
        "description": "",
        "tags": [
          "Product"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProductUpdateRequest"
              },
              "example": {
                "name": "스페셜티 원두 1kg",
                "description": "씁쓸함↓ 산미↑ 밸런스",
                "price": 20900,
                "isActive": false
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "유효성 검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "존재하지 않는 제품",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "status": 400,
                  "error": "Bad Request",
                  "code": "VALIDATION_ERROR",
                  "message": "product doesn't exist.",
                  "path": "/api/v1/products",
                  "timestamp": "2025-11-02T07:31:00.000Z"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth11": []
          }
        ]
      },
      "delete": {
        "summary": "제품 삭제",
        "deprecated": false,
        "description": "제품을 삭제합니다.",
        "tags": [
          "Product"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "삭제 성공",
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "존재하지 않는 제품",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth11": []
          }
        ]
      }
    },
    "/admin/inventories": {
      "post": {
        "summary": "재고 초기 생성(관리자)",
        "deprecated": false,
        "description": "지정한 productId에 대한 재고 레코드를 생성합니다. 이미 존재하면 409를 반환합니다.",
        "tags": [
          "Inventory"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InitInventoryRequest"
              },
              "example": {
                "productId": 501,
                "stock": 100
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "생성 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InventoryResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "이미 존재",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth21": []
          }
        ]
      }
    },
    "/admin/inventories/{productId}": {
      "get": {
        "summary": "재고 단건 조회(관리자)",
        "deprecated": false,
        "description": "운영용 조회. 일반 사용자 시나리오는 제품 조회 시 조인으로 재고를 반환합니다.",
        "tags": [
          "Inventory"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InventoryResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth21": []
          }
        ]
      },
      "patch": {
        "summary": "재고 수량 절대 설정(관리자)",
        "deprecated": false,
        "description": "",
        "tags": [
          "Inventory"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetStockRequest"
              },
              "example": {
                "stock": 120
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "설정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InventoryResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth21": []
          }
        ]
      }
    },
    "/admin/inventories/{productId}/add": {
      "post": {
        "summary": "재고 수량 증감(관리자)",
        "deprecated": false,
        "description": "delta만큼 증감합니다. 음수면 강제 차감입니다.",
        "tags": [
          "Inventory"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddStockRequest"
              },
              "example": {
                "delta": 20
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "반영 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InventoryResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth21": []
          }
        ]
      }
    },
    "/api/v1/inventories/{productId}/reserve": {
      "post": {
        "summary": "재고 예약(사용자)",
        "deprecated": false,
        "description": "예약은 reserved를 증가시키며, available(stock - reserved)보다 큰 qty는 409를 반환합니다.",
        "tags": [
          "Inventory"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReserveRequest"
              },
              "example": {
                "qty": 3,
                "orderId": 10001,
                "idempotencyKey": "ORD-10001-RES-1"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "예약 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InventoryResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "재고 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "가용 수량 부족 또는 중복 예약",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth21": []
          }
        ]
      }
    },
    "/api/v1/inventories/{productId}/release": {
      "post": {
        "summary": "재고 예약 해제(사용자)",
        "deprecated": false,
        "description": "결제 실패/취소 시 reserved를 감소시킵니다.",
        "tags": [
          "Inventory"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReleaseRequest"
              },
              "example": {
                "qty": 3,
                "orderId": 10001
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "해제 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InventoryResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "재고 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "해제 수량이 예약 수량을 초과",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth21": []
          }
        ]
      }
    },
    "/api/v1/inventories/{productId}/commit": {
      "post": {
        "summary": "재고 확정(사용자)",
        "deprecated": false,
        "description": "결제 성공 시 stock을 qty만큼 감소, reserved를 동일 수량만큼 감소시켜 확정합니다.",
        "tags": [
          "Inventory"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CommitRequest"
              },
              "example": {
                "qty": 3,
                "orderId": 10001
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "확정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InventoryResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "재고 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "예약 수량 부족 또는 동시성 충돌",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth21": []
          }
        ]
      }
    },
    "/admin/coupons": {
      "post": {
        "summary": "쿠폰 생성",
        "deprecated": false,
        "description": "새로운 쿠폰을 생성합니다. code는 유니크여야 합니다.",
        "tags": [
          "AdminCoupon"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CouponCreateRequest"
              },
              "example": {
                "code": "WELCOME10",
                "name": "신규 회원 10% 할인",
                "type": "PERCENT",
                "discount_value": 10,
                "min_order_amount": 30000,
                "start_at": "2025-11-01T00:00:00Z",
                "end_at": "2025-12-31T23:59:59Z",
                "is_active": true
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "생성 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CouponResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "충돌(code 중복 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth31": []
          }
        ]
      },
      "get": {
        "summary": "쿠폰 목록 조회",
        "deprecated": false,
        "description": "코드, 타입, 활성 여부, 기간으로 필터링하고 페이징합니다.",
        "tags": [
          "AdminCoupon"
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            }
          },
          {
            "name": "size",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "string",
              "example": "created_at,desc"
            }
          },
          {
            "name": "code",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "string",
              "example": "WELCOME10"
            }
          },
          {
            "name": "type",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "$ref": "#/components/schemas/CouponType"
            }
          },
          {
            "name": "is_active",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "start_from",
            "in": "query",
            "description": "시작일 하한(포함)",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "end_until",
            "in": "query",
            "description": "종료일 상한(포함)",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "q",
            "in": "query",
            "description": "코드/이름 부분 검색",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CouponPageResponse"
                },
                "example": {
                  "content": [
                    {
                      "id": 201,
                      "code": "WELCOME10",
                      "name": "신규 10% 할인",
                      "type": "PERCENT",
                      "discount_value": 10,
                      "min_order_amount": 30000,
                      "start_at": "2025-11-01T00:00:00Z",
                      "end_at": "2025-12-31T23:59:59Z",
                      "is_active": true,
                      "created_at": "2025-11-04T00:00:00Z"
                    },
                    {
                      "id": 198,
                      "code": "WELCOME3000",
                      "name": "신규 3천원 할인",
                      "type": "FIXED",
                      "discount_value": 3000,
                      "min_order_amount": 20000,
                      "start_at": null,
                      "end_at": null,
                      "is_active": true,
                      "created_at": "2025-10-28T10:15:00Z"
                    }
                  ],
                  "page": {
                    "number": 0,
                    "size": 2,
                    "totalElements": 9,
                    "totalPages": 5
                  }
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth31": []
          }
        ]
      }
    },
    "/admin/coupons/{id}": {
      "get": {
        "summary": "쿠폰 단건 조회",
        "deprecated": false,
        "description": "",
        "tags": [
          "AdminCoupon"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CouponResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth31": []
          }
        ]
      },
      "put": {
        "summary": "쿠폰 전체 수정",
        "deprecated": false,
        "description": "code 변경은 일반적으로 허용하지 않는 것을 권장합니다.",
        "tags": [
          "AdminCoupon"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CouponUpdateRequest"
              },
              "example": {
                "name": "연말 10% 할인",
                "type": "PERCENT",
                "discount_value": 10,
                "min_order_amount": 20000,
                "start_at": "2025-11-10T00:00:00Z",
                "end_at": "2026-01-31T23:59:59Z",
                "is_active": true
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CouponResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth31": []
          }
        ]
      },
      "patch": {
        "summary": "쿠폰 부분 수정",
        "deprecated": false,
        "description": "",
        "tags": [
          "AdminCoupon"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CouponUpdateRequest"
              },
              "example": {
                "is_active": false
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CouponResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth31": []
          }
        ]
      },
      "delete": {
        "summary": "쿠폰 삭제",
        "deprecated": false,
        "description": "테스트 데이터나 잘못 등록된 쿠폰 정리용 API.\n물리 삭제 대신 is_active=false를 권장합니다. ",
        "tags": [
          "AdminCoupon"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "삭제 성공",
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth31": []
          }
        ]
      }
    },
    "/admin/coupons/{id}/deactivate": {
      "post": {
        "summary": "쿠폰 비활성화",
        "deprecated": false,
        "description": "is_active 값을 false로 전환합니다.",
        "tags": [
          "AdminCoupon"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "비활성화 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CouponResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth31": []
          }
        ]
      }
    },
    "/api/v1/coupons/claim": {
      "post": {
        "summary": "쿠폰 코드 발급",
        "deprecated": false,
        "description": "코드를 검증하고 user_coupon을 생성합니다. 이미 보유한 경우 중복 발급을 거절합니다.",
        "tags": [
          "Coupon"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ClaimRequest"
              },
              "example": {
                "code": "WELCOME10"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "발급 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ClaimResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패(비활성/기간/형식)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "쿠폰 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "이미 발급됨 등 상태 충돌",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth41": []
          }
        ]
      }
    },
    "/api/v1/coupons/applicable": {
      "post": {
        "summary": "주문 맥락에서 적용 가능한 쿠폰 미리보기",
        "deprecated": false,
        "description": "",
        "tags": [
          "Coupon"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApplicableRequest"
              },
              "example": {
                "orderId": 10001,
                "includeInapplicable": false,
                "limit": 10
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "미리보기 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplicableResponse"
                },
                "example": {
                  "applicable": [
                    {
                      "userCouponId": 123,
                      "code": "WELCOME10",
                      "type": "PERCENT",
                      "previewDiscount": 3970,
                      "expiresAt": "2025-12-31T23:59:59Z"
                    }
                  ],
                  "inapplicable": [],
                  "meta": {
                    "orderId": 10001,
                    "currency": "KRW",
                    "sortedBy": "previewDiscount,desc",
                    "count": 1,
                    "countInapplicable": 0
                  }
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "주문 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/api/v1/orders/{orderId}/coupon/apply": {
      "post": {
        "summary": "주문에 쿠폰 적용(예약)",
        "deprecated": false,
        "description": "user_coupon을 ISSUED→RESERVED(TTL)로 전이하고 금액을 재계산합니다.",
        "tags": [
          "Coupon"
        ],
        "parameters": [
          {
            "name": "orderId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CouponApplyRequest"
              },
              "example": {
                "userCouponId": 123
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "적용 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CouponApplyResponse"
                },
                "example": {
                  "orderId": 10001,
                  "status": "CREATED",
                  "addressId": 555,
                  "memo": "문 앞",
                  "itemTotal": 25800,
                  "couponDiscount": 3000,
                  "payAmount": 22800,
                  "items": [
                    {
                      "productId": 501,
                      "productName": "베이직 티셔츠",
                      "unitPrice": 12900,
                      "qty": 2
                    }
                  ],
                  "appliedUserCouponId": 123,
                  "created_at": "2025-11-04T12:00:00Z"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패(비활성/기간/최소금액)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "주문/쿠폰 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "상태 충돌(이미 RESERVED/USED, 주문 상태 불가)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/api/v1/coupons/my": {
      "get": {
        "summary": "내 쿠폰 목록 조회",
        "deprecated": false,
        "description": "보유한 user_coupon 목록을 상태별로 조회합니다.",
        "tags": [
          "Coupon"
        ],
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "$ref": "#/components/schemas/UserCouponStatus"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "example": 0
            }
          },
          {
            "name": "size",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "example": 20
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MyCouponsResponse"
                },
                "example": {
                  "content": [
                    {
                      "userCouponId": 123,
                      "couponId": 201,
                      "code": "WELCOME10",
                      "status": "ISSUED",
                      "name": "신규 회원 10% 할인",
                      "type": "PERCENT",
                      "discount_value": 10,
                      "min_order_amount": 30000,
                      "start_at": "2025-11-01T00:00:00Z",
                      "end_at": "2025-12-31T23:59:59Z",
                      "issued_at": "2025-11-04T00:00:00Z"
                    }
                  ],
                  "page": {
                    "number": 0,
                    "size": 20,
                    "totalElements": 1,
                    "totalPages": 1
                  }
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth41": []
          }
        ]
      }
    },
    "/api/v1/orders/{orderId}/coupon/unapply": {
      "post": {
        "summary": "주문에서 쿠폰 해제",
        "deprecated": false,
        "description": "RESERVED→ISSUED 복귀 후 금액 재계산.",
        "tags": [
          "Coupon"
        ],
        "parameters": [
          {
            "name": "orderId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "해제 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrderSummary"
                },
                "example": {
                  "orderId": 10001,
                  "status": "CREATED",
                  "addressId": 555,
                  "memo": "문 앞",
                  "itemTotal": 39000,
                  "couponDiscount": 0,
                  "payAmount": 39000,
                  "items": [
                    {
                      "productId": 501,
                      "productName": "베이직 티셔츠",
                      "unitPrice": 12900,
                      "qty": 3
                    }
                  ],
                  "appliedUserCouponId": null,
                  "created_at": "2025-11-04T12:00:00Z"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "주문 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/api/v1/cart": {
      "get": {
        "summary": "내 장바구니 조회",
        "deprecated": false,
        "description": "로그인 사용자의 장바구니를 조회합니다. 상품/가격/재고는 현재 값으로 조인해 반환합니다.",
        "tags": [
          "Cart"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CartSummary"
                },
                "example": {
                  "items": [
                    {
                      "productId": 501,
                      "qty": 2,
                      "productName": "베이직 티셔츠",
                      "unitPrice": 12900,
                      "isActive": true,
                      "stock": 42,
                      "imageUrl": "https://cdn.example.com/p/501.jpg"
                    },
                    {
                      "productId": 777,
                      "qty": 1,
                      "productName": "코튼 팬츠",
                      "unitPrice": 12900,
                      "isActive": true,
                      "stock": 9,
                      "imageUrl": "https://cdn.example.com/p/777.jpg"
                    }
                  ],
                  "itemCount": 3,
                  "itemTotal": 38700,
                  "currency": "KRW",
                  "updatedAt": "2025-11-04T12:00:00Z"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth51": []
          }
        ]
      },
      "delete": {
        "summary": "장바구니 비우기",
        "deprecated": false,
        "description": "사용자의 장바구니를 모두 비웁니다. (JWT에 있는 userId 사용)",
        "tags": [
          "Cart"
        ],
        "parameters": [],
        "responses": {
          "204": {
            "description": "비우기 성공",
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth51": []
          }
        ]
      }
    },
    "/api/v1/cart/items": {
      "post": {
        "summary": "장바구니 라인 추가(UPSERT)",
        "deprecated": false,
        "description": "동일 상품이 이미 있으면 수량을 증가시킵니다. 최대 수량 정책은 서버에서 검증합니다.",
        "tags": [
          "Cart"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CartItemCreateRequest"
              },
              "example": {
                "productId": 501,
                "qty": 2
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "증가 성공(기존에 장바구니에 존재함)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CartSummary"
                }
              }
            },
            "headers": {}
          },
          "201": {
            "description": "신규 추가 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CartSummary"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패(수량, 상품 상태 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "상품 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "정책 충돌(최대 수량 초과 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth51": []
          }
        ]
      }
    },
    "/api/v1/cart/items/{productId}": {
      "put": {
        "summary": "특정 상품 수량 설정(절대값)",
        "deprecated": false,
        "description": "수량을 절대값으로 설정합니다. qty=0이면 삭제와 동일하게 처리할 수 있습니다(정책 선택).",
        "tags": [
          "Cart"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CartItemSetQtyRequest"
              },
              "example": {
                "qty": 3
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "설정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CartSummary"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패(음수, 상한 초과 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "장바구니 라인 없음 또는 상품 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth51": []
          }
        ]
      },
      "delete": {
        "summary": "특정 상품 라인 삭제",
        "deprecated": false,
        "description": "해당 상품을 장바구니에서 제거합니다.",
        "tags": [
          "Cart"
        ],
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "삭제 성공",
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "장바구니 라인 없음 또는 상품 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth51": []
          }
        ]
      }
    },
    "/api/v1/orders/draft": {
      "post": {
        "summary": "주문 초안 생성",
        "deprecated": false,
        "description": "선택된 장바구니 라인으로 주문과 주문항목 스냅샷을 생성합니다. 재고는 소프트홀드(TTL) 가능.",
        "tags": [
          "Order"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DraftCreateRequest"
              },
              "example": {
                "cartItemIds": [
                  101,
                  103,
                  109
                ],
                "addressId": 555,
                "memo": "문 앞"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "생성 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DraftCreateResponse"
                },
                "example": {
                  "orderId": 10001,
                  "status": "CREATED",
                  "addressId": 555,
                  "memo": "문 앞",
                  "itemTotal": 39000,
                  "couponDiscount": 0,
                  "payAmount": 42000,
                  "items": [
                    {
                      "productId": 501,
                      "productName": "베이직 티셔츠",
                      "unitPrice": 12900,
                      "qty": 2
                    },
                    {
                      "productId": 777,
                      "productName": "코튼 팬츠",
                      "unitPrice": 13200,
                      "qty": 1
                    }
                  ],
                  "appliedUserCouponId": null,
                  "created_at": "2025-11-04T12:00:00Z"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패(장바구니/주소/상품 상태)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "리소스 없음(주소/장바구니 라인)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/api/v1/orders/{orderId}": {
      "get": {
        "summary": "주문 상세 조회",
        "deprecated": false,
        "description": "",
        "tags": [
          "Order"
        ],
        "parameters": [
          {
            "name": "orderId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "orderId": {
                      "type": "integer",
                      "format": "int64",
                      "example": 10001
                    },
                    "status": {
                      "$ref": "#/components/schemas/OrderStatus"
                    },
                    "addressId": {
                      "type": "integer",
                      "format": "int64",
                      "example": 555
                    },
                    "memo": {
                      "type": "string",
                      "example": "문 앞"
                    },
                    "itemTotal": {
                      "type": "number",
                      "example": 39000
                    },
                    "couponDiscount": {
                      "type": "number",
                      "example": 3000
                    },
                    "payAmount": {
                      "type": "number",
                      "example": 39000
                    },
                    "items": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/OrderItem"
                      }
                    },
                    "appliedUserCouponId": {
                      "type": "integer",
                      "format": "int64",
                      "nullable": true,
                      "example": 123
                    },
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-11-04T12:00:00Z"
                    }
                  },
                  "required": [
                    "orderId",
                    "status",
                    "itemTotal",
                    "couponDiscount",
                    "payAmount",
                    "items",
                    "created_at"
                  ]
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "주문 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/api/v1/orders/my": {
      "get": {
        "summary": "나의 주문 목록",
        "deprecated": false,
        "description": "",
        "tags": [
          "Order"
        ],
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "$ref": "#/components/schemas/OrderStatus"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "example": 0
            }
          },
          {
            "name": "size",
            "in": "query",
            "description": "",
            "required": false,
            "schema": {
              "type": "integer",
              "example": 20
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "content": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/OrderSummary"
                      }
                    },
                    "page": {
                      "type": "object",
                      "properties": {
                        "number": {
                          "type": "integer",
                          "example": 0
                        },
                        "size": {
                          "type": "integer",
                          "example": 20
                        },
                        "totalElements": {
                          "type": "integer",
                          "example": 1
                        },
                        "totalPages": {
                          "type": "integer",
                          "example": 1
                        }
                      }
                    }
                  }
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/api/v1/orders/{orderId}/cancel": {
      "post": {
        "summary": "주문 취소(결제 전)",
        "deprecated": false,
        "description": "CREATED 또는 PENDING_PAYMENT 상태에서만 취소. 쿠폰/재고 예약 해제.",
        "tags": [
          "Order"
        ],
        "parameters": [
          {
            "name": "orderId",
            "in": "path",
            "description": "",
            "required": true,
            "example": 0,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "취소 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrderSummary"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "404": {
            "description": "주문 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "상태 충돌(이미 PAID 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/api/v1/orders/{orderId}/checkout": {
      "post": {
        "summary": "체크아웃(결제 인텐트 생성)",
        "deprecated": false,
        "description": "최종 reprice 후 결제 세션을 생성하고 주문을 PENDING_PAYMENT로 전이합니다.",
        "tags": [
          "Payment"
        ],
        "parameters": [
          {
            "name": "orderId",
            "in": "path",
            "description": "",
            "required": true,
            "example": "",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Idempotency-Key",
            "in": "header",
            "description": "",
            "required": true,
            "example": "",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CheckoutRequest"
              },
              "example": {
                "paymentMethod": "CARD"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "결제 세션 생성",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CheckoutResponse"
                }
              }
            },
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "401": {
            "description": "인증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          },
          "409": {
            "description": "상태 충돌(이미 결제 진행 중)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [
          {
            "bearerAuth61": []
          }
        ]
      }
    },
    "/internal/payments/webhook": {
      "post": {
        "summary": "결제 웹훅(내부)",
        "deprecated": false,
        "description": "PG 서명 검증 후 성공이면 order=PAID, payment=SUCCEEDED(approved_at), 쿠폰=USED, 재고 커밋. 실패면 FAILED 및 예약 해제.",
        "tags": [
          "Payment"
        ],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true,
                "properties": {}
              },
              "example": {
                "event": "payment.succeeded",
                "paymentSessionId": "pi_abc123",
                "orderId": 10001,
                "amount": 35730
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "수신 성공(멱등)",
            "headers": {}
          },
          "400": {
            "description": "검증 실패",
            "headers": {}
          }
        },
        "security": []
      }
    }
  },
  "components": {
    "schemas": {
      "ErrorResponse": {
        "type": "object",
        "required": [
          "status",
          "error",
          "code",
          "message",
          "path",
          "timestamp"
        ],
        "properties": {
          "status": {
            "type": "integer",
            "example": 400
          },
          "error": {
            "type": "string",
            "example": "Bad Request"
          },
          "code": {
            "type": "string",
            "example": "VALIDATION_ERROR"
          },
          "message": {
            "type": "string",
            "example": "Invalid field values."
          },
          "path": {
            "type": "string",
            "example": "/api/v1/orders/draft"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-04T12:00:00Z"
          }
        }
      },
      "AddressCreateRequest": {
        "type": "object",
        "required": [
          "receiver",
          "phone",
          "zipcode"
        ],
        "properties": {
          "receiver": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100,
            "example": "홍길동"
          },
          "phone": {
            "type": "string",
            "description": "국내 숫자만 또는 E.164(+821012345678) 허용",
            "minLength": 7,
            "maxLength": 20,
            "example": "01012345678"
          },
          "zipcode": {
            "type": "string",
            "minLength": 3,
            "maxLength": 10,
            "example": "06236"
          },
          "memo": {
            "type": "string",
            "maxLength": 255,
            "nullable": true,
            "example": "경비실 맡겨주세요"
          },
          "isDefault": {
            "type": "boolean",
            "default": false,
            "example": true
          }
        }
      },
      "ProductCreateRequest": {
        "type": "object",
        "required": [
          "name",
          "price"
        ],
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 255,
            "example": "프리미엄 커피 원두 1kg"
          },
          "description": {
            "type": "string",
            "example": "고소한 향의 아라비카 블렌드 원두"
          },
          "price": {
            "type": "number",
            "example": 19900
          },
          "isActive": {
            "type": "boolean",
            "default": true,
            "example": true
          }
        }
      },
      "InventoryResponse": {
        "type": "object",
        "required": [
          "productId",
          "stock",
          "reserved",
          "updatedAt"
        ],
        "properties": {
          "productId": {
            "type": "integer",
            "format": "int64",
            "example": 501
          },
          "stock": {
            "type": "integer",
            "example": 100
          },
          "reserved": {
            "type": "integer",
            "example": 5
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-02T09:00:00.000Z"
          }
        }
      },
      "CouponType": {
        "type": "string",
        "enum": [
          "PERCENT",
          "FIXED"
        ],
        "example": "PERCENT"
      },
      "CartItemCreateRequest": {
        "type": "object",
        "required": [
          "productId",
          "qty"
        ],
        "properties": {
          "productId": {
            "type": "integer",
            "format": "int64",
            "example": 501
          },
          "qty": {
            "type": "integer",
            "minimum": 1,
            "example": 2
          }
        }
      },
      "OrderStatus": {
        "type": "string",
        "enum": [
          "CREATED",
          "PENDING_PAYMENT",
          "PAID",
          "CANCELLED"
        ],
        "example": "CREATED"
      },
      "TokenResponse": {
        "type": "object",
        "required": [
          "accessToken"
        ],
        "properties": {
          "accessToken": {
            "type": "string"
          }
        }
      },
      "AddressResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "example": 101
          },
          "receiver": {
            "type": "string",
            "example": "홍길동"
          },
          "phone": {
            "type": "string",
            "example": "01012345678"
          },
          "zipcode": {
            "type": "string",
            "example": "06236"
          },
          "memo": {
            "type": "string",
            "example": "문 앞에 두세요"
          },
          "isDefault": {
            "type": "boolean",
            "example": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-02T07:00:00Z"
          }
        }
      },
      "ProductUpdateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 255,
            "example": "스페셜티 원두 1kg"
          },
          "description": {
            "type": "string",
            "example": "씁쓸함↓ 산미↑ 밸런스"
          },
          "price": {
            "type": "number",
            "example": 20900
          },
          "isActive": {
            "type": "boolean",
            "example": false
          }
        }
      },
      "InitInventoryRequest": {
        "type": "object",
        "required": [
          "productId",
          "stock"
        ],
        "properties": {
          "productId": {
            "type": "integer",
            "format": "int64",
            "example": 501
          },
          "stock": {
            "type": "integer",
            "minimum": 0,
            "example": 100
          }
        }
      },
      "CouponCreateRequest": {
        "type": "object",
        "required": [
          "code",
          "type",
          "discount_value"
        ],
        "properties": {
          "code": {
            "type": "string",
            "maxLength": 50,
            "example": "WELCOME10"
          },
          "name": {
            "type": "string",
            "maxLength": 100,
            "example": "신규 회원 10% 할인"
          },
          "type": {
            "$ref": "#/components/schemas/CouponType"
          },
          "discount_value": {
            "type": "number",
            "description": "PERCENT일 때 퍼센트(예: 10), FIXED일 때 금액(예: 3000)",
            "example": 10
          },
          "min_order_amount": {
            "type": "number",
            "nullable": true,
            "example": 30000
          },
          "start_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2025-11-01T00:00:00Z"
          },
          "end_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2025-12-31T23:59:59Z"
          },
          "is_active": {
            "type": "boolean",
            "default": true,
            "example": true
          }
        }
      },
      "UserCouponStatus": {
        "type": "string",
        "enum": [
          "ISSUED",
          "RESERVED",
          "USED",
          "EXPIRED"
        ],
        "example": "ISSUED"
      },
      "CartItemSetQtyRequest": {
        "type": "object",
        "required": [
          "qty"
        ],
        "properties": {
          "qty": {
            "type": "integer",
            "minimum": 0,
            "example": 3
          }
        }
      },
      "PaymentStatus": {
        "type": "string",
        "enum": [
          "REQUESTED",
          "SUCCEEDED",
          "FAILED"
        ],
        "example": "REQUESTED"
      },
      "SignupResponse": {
        "type": "object",
        "required": [
          "id",
          "username",
          "email"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "username": {
            "type": "string"
          },
          "email": {
            "type": "string",
            "format": "email"
          }
        }
      },
      "AddressUpdateRequest": {
        "type": "object",
        "properties": {
          "receiver": {
            "type": "string",
            "example": "이순신"
          },
          "phone": {
            "type": "string",
            "example": "01099998888"
          },
          "zipcode": {
            "type": "string",
            "example": "04524"
          },
          "memo": {
            "type": "string",
            "example": "회사 리셉션 보관"
          },
          "isDefault": {
            "type": "boolean",
            "example": false
          }
        },
        "required": [
          "receiver",
          "phone",
          "zipcode"
        ]
      },
      "ProductResponse": {
        "type": "object",
        "required": [
          "product_id",
          "name",
          "description",
          "price",
          "isActive",
          "createdAt",
          "inventory_id"
        ],
        "properties": {
          "product_id": {
            "type": "integer",
            "example": 501
          },
          "inventory_id": {
            "type": "integer",
            "nullable": true
          },
          "name": {
            "type": "string",
            "example": "프리미엄 커피 원두 1kg"
          },
          "description": {
            "type": "string",
            "example": "고소한 향의 아라비카 블렌드 원두"
          },
          "price": {
            "type": "number",
            "example": 19900
          },
          "isActive": {
            "type": "boolean",
            "example": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-02T07:30:00.000Z"
          }
        }
      },
      "SetStockRequest": {
        "type": "object",
        "required": [
          "stock"
        ],
        "properties": {
          "stock": {
            "type": "integer",
            "minimum": 0,
            "example": 120
          }
        }
      },
      "CouponUpdateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "example": "연말 10% 할인"
          },
          "type": {
            "$ref": "#/components/schemas/CouponType"
          },
          "discount_value": {
            "type": "number",
            "example": 10
          },
          "min_order_amount": {
            "type": "number",
            "nullable": true,
            "example": 20000
          },
          "start_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2025-11-10T00:00:00Z"
          },
          "end_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2026-01-31T23:59:59Z"
          },
          "is_active": {
            "type": "boolean",
            "example": false
          }
        }
      },
      "ClaimRequest": {
        "type": "object",
        "required": [
          "code"
        ],
        "properties": {
          "code": {
            "type": "string",
            "maxLength": 50,
            "example": "WELCOME10"
          }
        }
      },
      "CartItem": {
        "type": "object",
        "required": [
          "productId",
          "qty"
        ],
        "properties": {
          "productId": {
            "type": "integer",
            "format": "int64",
            "example": 501
          },
          "qty": {
            "type": "integer",
            "example": 2
          },
          "productName": {
            "type": "string",
            "example": "베이직 티셔츠"
          },
          "unitPrice": {
            "type": "number",
            "example": 12900
          },
          "isActive": {
            "type": "boolean",
            "example": true
          },
          "stock": {
            "type": "integer",
            "nullable": true,
            "example": 42
          },
          "imageUrl": {
            "type": "string",
            "nullable": true,
            "example": "https://cdn.example.com/p/501.jpg"
          }
        }
      },
      "OrderItem": {
        "type": "object",
        "required": [
          "productId",
          "productName",
          "unitPrice",
          "qty"
        ],
        "properties": {
          "productId": {
            "type": "integer",
            "format": "int64",
            "example": 501
          },
          "productName": {
            "type": "string",
            "example": "베이직 티셔츠"
          },
          "unitPrice": {
            "type": "number",
            "example": 12900
          },
          "qty": {
            "type": "integer",
            "example": 2
          }
        }
      },
      "ProductPageResponse": {
        "type": "object",
        "properties": {
          "content": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductResponse"
            }
          },
          "page": {
            "type": "object",
            "properties": {
              "number": {
                "type": "integer",
                "example": 0
              },
              "size": {
                "type": "integer",
                "example": 20
              },
              "totalElements": {
                "type": "integer",
                "example": 1
              },
              "totalPages": {
                "type": "integer",
                "example": 1
              }
            }
          }
        }
      },
      "AddStockRequest": {
        "type": "object",
        "required": [
          "delta"
        ],
        "properties": {
          "delta": {
            "type": "integer",
            "example": 20
          }
        },
        "description": "양수면 입고, 음수면 강제 차감(관리자 전용)"
      },
      "CouponResponse": {
        "type": "object",
        "required": [
          "id",
          "code",
          "name",
          "type",
          "discount_value",
          "min_order_amount",
          "start_at",
          "end_at",
          "is_active",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "example": 101
          },
          "code": {
            "type": "string",
            "example": "WELCOME10"
          },
          "name": {
            "type": "string",
            "example": "신규 회원 10% 할인"
          },
          "type": {
            "$ref": "#/components/schemas/CouponType"
          },
          "discount_value": {
            "type": "number",
            "example": 10
          },
          "min_order_amount": {
            "type": "number",
            "nullable": true,
            "example": 30000
          },
          "start_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2025-11-01T00:00:00Z"
          },
          "end_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2025-12-31T23:59:59Z"
          },
          "is_active": {
            "type": "boolean",
            "example": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-04T00:00:00Z"
          }
        }
      },
      "ClaimResponse": {
        "type": "object",
        "required": [
          "userCouponId",
          "code",
          "status",
          "couponId"
        ],
        "properties": {
          "userCouponId": {
            "type": "integer",
            "format": "int64",
            "example": 123
          },
          "couponId": {
            "type": "integer",
            "format": "int64",
            "example": 201
          },
          "code": {
            "type": "string",
            "example": "WELCOME10"
          },
          "status": {
            "$ref": "#/components/schemas/UserCouponStatus"
          },
          "name": {
            "type": "string",
            "example": "신규 회원 10% 할인"
          },
          "type": {
            "$ref": "#/components/schemas/CouponType"
          },
          "discount_value": {
            "type": "number",
            "example": 10
          },
          "min_order_amount": {
            "type": "number",
            "example": 30000
          },
          "start_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-01T00:00:00Z"
          },
          "end_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-12-31T23:59:59Z"
          }
        }
      },
      "CartSummary": {
        "type": "object",
        "required": [
          "items",
          "itemCount",
          "itemTotal",
          "currency"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CartItem"
            }
          },
          "itemCount": {
            "type": "integer",
            "example": 3
          },
          "itemTotal": {
            "type": "number",
            "example": 38700
          },
          "currency": {
            "type": "string",
            "example": "KRW"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-04T12:00:00Z"
          }
        }
      },
      "OrderSummary": {
        "type": "object",
        "required": [
          "orderId",
          "status",
          "itemTotal",
          "couponDiscount",
          "payAmount",
          "items",
          "created_at"
        ],
        "properties": {
          "orderId": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          },
          "status": {
            "$ref": "#/components/schemas/OrderStatus"
          },
          "addressId": {
            "type": "integer",
            "format": "int64",
            "example": 555
          },
          "memo": {
            "type": "string",
            "example": "문 앞"
          },
          "itemTotal": {
            "type": "number",
            "example": 39000
          },
          "couponDiscount": {
            "type": "number",
            "example": 3000
          },
          "payAmount": {
            "type": "number",
            "example": 39000
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OrderItem"
            }
          },
          "appliedUserCouponId": {
            "type": "integer",
            "format": "int64",
            "nullable": true,
            "example": 123
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-04T12:00:00Z"
          }
        }
      },
      "ValidationErrorResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ErrorResponse"
          },
          {
            "type": "object",
            "properties": {
              "details": {
                "type": "array",
                "description": "필드별 검증 실패 상세",
                "items": {
                  "type": "object",
                  "required": [
                    "field",
                    "reason"
                  ],
                  "properties": {
                    "field": {
                      "type": "string",
                      "example": "phone"
                    },
                    "reason": {
                      "type": "string",
                      "example": "must be 7-20 digits or E.164 format"
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "ReserveRequest": {
        "type": "object",
        "required": [
          "qty",
          "orderId"
        ],
        "properties": {
          "qty": {
            "type": "integer",
            "minimum": 1,
            "example": 3
          },
          "orderId": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          },
          "idempotencyKey": {
            "type": "string",
            "example": "ORD-10001-RES-1"
          }
        }
      },
      "CouponPageResponse": {
        "type": "object",
        "properties": {
          "content": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CouponResponse"
            }
          },
          "page": {
            "type": "object",
            "properties": {
              "number": {
                "type": "integer",
                "example": 0
              },
              "size": {
                "type": "integer",
                "example": 20
              },
              "totalElements": {
                "type": "integer",
                "example": 2
              },
              "totalPages": {
                "type": "integer",
                "example": 1
              }
            }
          }
        }
      },
      "UserCouponSummary": {
        "type": "object",
        "required": [
          "userCouponId",
          "couponId",
          "code",
          "status"
        ],
        "properties": {
          "userCouponId": {
            "type": "integer",
            "format": "int64",
            "example": 123
          },
          "couponId": {
            "type": "integer",
            "format": "int64",
            "example": 201
          },
          "code": {
            "type": "string",
            "example": "WELCOME10"
          },
          "status": {
            "$ref": "#/components/schemas/UserCouponStatus"
          },
          "name": {
            "type": "string",
            "example": "신규 회원 10% 할인"
          },
          "type": {
            "$ref": "#/components/schemas/CouponType"
          },
          "discount_value": {
            "type": "number",
            "example": 10
          },
          "min_order_amount": {
            "type": "number",
            "example": 30000
          },
          "start_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-01T00:00:00Z"
          },
          "end_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-12-31T23:59:59Z"
          },
          "issued_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-04T00:00:00Z"
          },
          "used_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-10T10:30:00Z"
          },
          "order_id": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          }
        }
      },
      "DraftCreateRequest": {
        "type": "object",
        "required": [
          "cartItemIds",
          "addressId"
        ],
        "properties": {
          "cartItemIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int64"
            },
            "example": [
              101,
              103,
              109
            ]
          },
          "addressId": {
            "type": "integer",
            "format": "int64",
            "example": 555
          },
          "memo": {
            "type": "string",
            "example": "문 앞"
          }
        }
      },
      "ReleaseRequest": {
        "type": "object",
        "required": [
          "qty",
          "orderId"
        ],
        "properties": {
          "qty": {
            "type": "integer",
            "minimum": 1,
            "example": 3
          },
          "orderId": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          }
        }
      },
      "MyCouponsResponse": {
        "type": "object",
        "properties": {
          "content": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserCouponSummary"
            }
          },
          "page": {
            "type": "object",
            "properties": {
              "number": {
                "type": "integer",
                "example": 0
              },
              "size": {
                "type": "integer",
                "example": 20
              },
              "totalElements": {
                "type": "integer",
                "example": 2
              },
              "totalPages": {
                "type": "integer",
                "example": 1
              }
            }
          }
        }
      },
      "DraftCreateResponse": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "orderId": {
                "type": "integer",
                "format": "int64",
                "example": 10001
              },
              "status": {
                "$ref": "#/components/schemas/OrderStatus"
              },
              "addressId": {
                "type": "integer",
                "format": "int64",
                "example": 555
              },
              "memo": {
                "type": "string",
                "example": "문 앞"
              },
              "itemTotal": {
                "type": "number",
                "example": 39000
              },
              "couponDiscount": {
                "type": "number",
                "example": 3000
              },
              "payAmount": {
                "type": "number",
                "example": 39000
              },
              "items": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/OrderItem"
                }
              },
              "appliedUserCouponId": {
                "type": "integer",
                "format": "int64",
                "nullable": true,
                "example": 123
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "example": "2025-11-04T12:00:00Z"
              }
            },
            "required": [
              "orderId",
              "status",
              "itemTotal",
              "couponDiscount",
              "payAmount",
              "items",
              "created_at"
            ]
          }
        ]
      },
      "CommitRequest": {
        "type": "object",
        "required": [
          "qty",
          "orderId"
        ],
        "properties": {
          "qty": {
            "type": "integer",
            "minimum": 1,
            "example": 3
          },
          "orderId": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          }
        }
      },
      "ApplicableRequest": {
        "type": "object",
        "required": [
          "orderId"
        ],
        "properties": {
          "orderId": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          },
          "includeInapplicable": {
            "type": "boolean",
            "default": false,
            "example": false
          },
          "limit": {
            "type": "integer",
            "minimum": 1,
            "maximum": 50,
            "default": 10,
            "example": 10
          }
        }
      },
      "CouponApplyRequest": {
        "type": "object",
        "properties": {
          "userCouponId": {
            "type": "integer",
            "format": "int64",
            "example": 123
          },
          "code": {
            "type": "string",
            "example": "WELCOME10"
          }
        }
      },
      "ApplicableItem": {
        "type": "object",
        "required": [
          "userCouponId",
          "code",
          "type",
          "previewDiscount"
        ],
        "properties": {
          "userCouponId": {
            "type": "integer",
            "format": "int64",
            "example": 123
          },
          "code": {
            "type": "string",
            "example": "WELCOME10"
          },
          "type": {
            "type": "string",
            "enum": [
              "PERCENT",
              "FIXED"
            ],
            "example": "PERCENT"
          },
          "previewDiscount": {
            "type": "number",
            "example": 3970
          },
          "expiresAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2025-12-31T23:59:59Z"
          }
        }
      },
      "CouponApplyResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/OrderSummary"
          }
        ]
      },
      "InapplicableItem": {
        "type": "object",
        "required": [
          "userCouponId",
          "reasonCode"
        ],
        "properties": {
          "userCouponId": {
            "type": "integer",
            "format": "int64",
            "example": 130
          },
          "reasonCode": {
            "type": "string",
            "enum": [
              "INACTIVE",
              "NOT_STARTED",
              "EXPIRED",
              "MIN_ORDER_NOT_MET",
              "SCOPE_MISMATCH",
              "STACKING_NOT_ALLOWED",
              "ALREADY_RESERVED",
              "ALREADY_USED",
              "ORDER_NOT_MODIFIABLE"
            ],
            "example": "MIN_ORDER_NOT_MET"
          }
        }
      },
      "ApplicableResponse": {
        "type": "object",
        "properties": {
          "applicable": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApplicableItem"
            }
          },
          "inapplicable": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/InapplicableItem"
            }
          },
          "meta": {
            "type": "object",
            "properties": {
              "orderId": {
                "type": "integer",
                "format": "int64",
                "example": 10001
              },
              "currency": {
                "type": "string",
                "example": "KRW"
              },
              "sortedBy": {
                "type": "string",
                "example": "previewDiscount,desc"
              },
              "count": {
                "type": "integer",
                "example": 2
              },
              "countInapplicable": {
                "type": "integer",
                "example": 0
              }
            }
          }
        }
      },
      "ApplyRequest": {
        "type": "object",
        "properties": {
          "userCouponId": {
            "type": "integer",
            "format": "int64",
            "example": 123
          },
          "code": {
            "type": "string",
            "example": "WELCOME10"
          }
        }
      },
      "ApplyResponse": {
        "type": "object",
        "required": [
          "orderId",
          "couponDiscount",
          "payAmount"
        ],
        "properties": {
          "orderId": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          },
          "couponDiscount": {
            "type": "number",
            "example": 3970
          },
          "payAmount": {
            "type": "number",
            "example": 35730
          },
          "appliedUserCouponId": {
            "type": "integer",
            "format": "int64",
            "example": 123
          },
          "couponStatus": {
            "type": "string",
            "example": "RESERVED"
          }
        }
      },
      "CheckoutRequest": {
        "type": "object",
        "properties": {
          "paymentMethod": {
            "type": "string",
            "example": "CARD"
          }
        }
      },
      "CheckoutResponse": {
        "type": "object",
        "required": [
          "orderId",
          "payAmount",
          "paymentSessionId"
        ],
        "properties": {
          "orderId": {
            "type": "integer",
            "format": "int64",
            "example": 10001
          },
          "payAmount": {
            "type": "number",
            "example": 35730
          },
          "paymentSessionId": {
            "type": "string",
            "example": "pi_abc123"
          },
          "redirectUrl": {
            "type": "string",
            "example": "https://pg.example/checkout/pi_abc123"
          }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth7": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "bearerAuth11": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "bearerAuth21": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "bearerAuth31": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "bearerAuth41": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "bearerAuth51": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "bearerAuth61": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "servers": [],
  "security": []
}
